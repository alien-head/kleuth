(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{133:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/pizza_api_structure_routes-39d6e6da60a4429f05cc295620e9afb2.png"},64:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return s})),n.d(t,"toc",(function(){return l})),n.d(t,"default",(function(){return d}));var a=n(3),r=n(7),i=(n(0),n(88)),o={title:"Handling Requests",slug:"/framework/request-handling"},s={unversionedId:"request-handling",id:"request-handling",isDocsHomePage:!1,title:"Handling Requests",description:"Route handler classes can be created in a few ways, depending on preferred style.",source:"@site/docs/request-handling.md",slug:"/framework/request-handling",permalink:"/kleuth/docs/framework/request-handling",editUrl:"https://github.com/alienhead/kleuth/edit/master/documentation/docs/request-handling.md",version:"current",sidebar:"docs",previous:{title:"Structuring the API",permalink:"/kleuth/docs/framework/structure"},next:{title:"Path Variables",permalink:"/kleuth/docs/framework/path-variables"}},l=[{value:"Route",id:"route",children:[]},{value:"RequestMethod",id:"requestmethod",children:[]},{value:"Request Method Handler Functions",id:"request-method-handler-functions",children:[{value:"Handler",id:"handler",children:[]},{value:"Request Method as Function Name",id:"request-method-as-function-name",children:[]},{value:"Request Method as Annotation",id:"request-method-as-annotation",children:[]}]},{value:"Overridding the Path",id:"overridding-the-path",children:[]}],c={toc:l};function d(e){var t=e.components,o=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},c,o,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"Route handler classes can be created in a few ways, depending on preferred style."),Object(i.b)("h3",{id:"route"},"Route"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"Route")," is the standard annotation that tells Kleuth a class handles one or more request methods.\nClasses with this annotation should have unique names ",Object(i.b)("inlineCode",{parentName:"p"},"GetPizzas"),", ",Object(i.b)("inlineCode",{parentName:"p"},"GetOrders"),", etc.\nClasses with ",Object(i.b)("inlineCode",{parentName:"p"},"@Route")," are also annotated with the Spring ",Object(i.b)("inlineCode",{parentName:"p"},"RestController")," annotation, allowing for backwards compatibility with Spring ",Object(i.b)("inlineCode",{parentName:"p"},"RestController")," features."),Object(i.b)("p",null,"A class using the ",Object(i.b)("inlineCode",{parentName:"p"},"Route")," annotation would look like this:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-kotlin"},"@Route\nclass GetPizzas { \n    // ...\n}\n")),Object(i.b)("h3",{id:"requestmethod"},"RequestMethod"),Object(i.b)("p",null,"Classes can instead be annotated with ",Object(i.b)("inlineCode",{parentName:"p"},"RequestMethod")," to set a request method of the handler as the class name.\n",Object(i.b)("inlineCode",{parentName:"p"},"RequestMethod")," must be used along with the Spring ",Object(i.b)("inlineCode",{parentName:"p"},"RestController")," annotation.\n:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-kotlin"},'@RequestMethod\n@RestController("get-pizzas")\nclass Get { \n    // ...\n}\n')),Object(i.b)("p",null,"This style can make the directory structure even more concise:"),Object(i.b)("p",null,Object(i.b)("img",{alt:"Pizza Restauruant REST API Routes",src:n(133).default})),Object(i.b)("h2",{id:"request-method-handler-functions"},"Request Method Handler Functions"),Object(i.b)("p",null,"A ",Object(i.b)("inlineCode",{parentName:"p"},"RequestMethod")," or ",Object(i.b)("inlineCode",{parentName:"p"},"Route")," class may handle one, or many request methods with several options for style."),Object(i.b)("p",null,"These functions act just like Spring ",Object(i.b)("inlineCode",{parentName:"p"},"RequestMapping")," functions,\nallowing the use of Spring function parameter annotations like ",Object(i.b)("inlineCode",{parentName:"p"},"@PathVariable"),", ",Object(i.b)("inlineCode",{parentName:"p"},"RequestBody"),", ",Object(i.b)("inlineCode",{parentName:"p"},"Valid"),", and ",Object(i.b)("inlineCode",{parentName:"p"},"RequestParam"),", to name a few.\nThis also means parameters like ",Object(i.b)("inlineCode",{parentName:"p"},"Authentication")," are supported."),Object(i.b)("h3",{id:"handler"},"Handler"),Object(i.b)("p",null,"The word ",Object(i.b)("inlineCode",{parentName:"p"},"handler")," is a reserved function name which tells Kleuth the class has one request method handler.\nIn this case, the class name should start or end with the request method handled by the function."),Object(i.b)("p",null,"Using the pizza api example, the class to handle ",Object(i.b)("inlineCode",{parentName:"p"},"GET /pizzas")," would look like this:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-kotlin"},"@Route\nclass GetPizzas(private val service: PizzaService) {\n    fun handler(): ResponseEntity<List<Pizza>> {\n        return ResponseEntity.ok(service.getAll())\n    }\n} \n")),Object(i.b)("h3",{id:"request-method-as-function-name"},"Request Method as Function Name"),Object(i.b)("p",null,"The request method handler function can be named after one of the supported request methods (get, post, put, delete):"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-kotlin"},"@Route\nclass GetPizzas(private val service: PizzaService) {\n    fun get(): ResponseEntity<List<Pizza>> {\n        return ResponseEntity.ok(service.getAll())\n    }\n} \n")),Object(i.b)("p",null,"This style may be used to put more than one request method in one class:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-kotlin"},"@Route\nclass EditDeliveryDriver(private val service: OrderService) {\n\n    fun post(/* ... */): ResponseEntity<Unit> {\n        // ...\n    }\n\n    fun put(/* ... */): ResponseEntity<Unit> {\n        // ...\n    }\n}\n")),Object(i.b)("h3",{id:"request-method-as-annotation"},"Request Method as Annotation"),Object(i.b)("p",null,"Using the request method annotations can free up the function name to be more specific:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-kotlin"},"@Route\nclass GetPizzas(private val service: PizzaService) {\n    @Get\n    fun getAllPizzas(): ResponseEntity<List<Pizza>> {\n        return ResponseEntity.ok(service.getAll())\n    }\n} \n")),Object(i.b)("p",null,"This style may be used to put more than one request method in one class:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-kotlin"},"@Route\nclass EditDeliveryDriver(private val service: OrderService) {\n\n    @Post\n    fun assignDeliveryDriver(/* ... */): ResponseEntity<Unit> {\n        // ...\n    }\n\n    @Put\n    fun reassignDeliveryDriver(/* ... */): ResponseEntity<Unit> {\n        // ...\n    }\n}\n")),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"Since one of Kleuth's goals is to de-obfuscate the REST API structure,\nincluding more than one handler function per class may not always be ideal."))),Object(i.b)("h2",{id:"overridding-the-path"},"Overridding the Path"),Object(i.b)("p",null,"It is possible to override the dynamic path Kleuth would create.\nThis is useful if the path does not match the directory structure, ",Object(i.b)("em",{parentName:"p"},"but should be used only when necessary.")),Object(i.b)("p",null,"Simply pass the override path into the ",Object(i.b)("inlineCode",{parentName:"p"},"RequestMethod")," or ",Object(i.b)("inlineCode",{parentName:"p"},"Route")," annotation:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-kotlin"},'@Route("/pizzas/{pizzaId}")\nclass GetPizzaById(\n    private val service: PizzaService\n) {\n    fun get(@PathVariable id: UUID): ResponseEntity<Pizza> {\n        val pizza = service.findById(id) ?: throw Exception("Pizza not found")\n        return ResponseEntity.ok(pizza)\n    }\n}\n')),Object(i.b)("p",null,"The path string should be formatted as one would format a Spring ",Object(i.b)("inlineCode",{parentName:"p"},"RequestMapping")," path."),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"All route handler classes nested under the route handler with the overridden path must also manually set their path"))))}d.isMDXComponent=!0},88:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return h}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=r.a.createContext({}),d=function(e){var t=r.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=d(e.components);return r.a.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},b=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=d(n),b=a,h=u["".concat(o,".").concat(b)]||u[b]||p[b]||i;return n?r.a.createElement(h,s(s({ref:t},c),{},{components:n})):r.a.createElement(h,s({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=b;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var c=2;c<i;c++)o[c]=n[c];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"}}]);